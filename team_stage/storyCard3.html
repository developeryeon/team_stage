<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>소개하기</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<!-- //jQuery -->

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
	<!-- //bootstrap -->

	<link rel="stylesheet" href="sub.css" />
	<!-- //css -->

	<script type="module">
		// Firebase SDK 라이브러리 가져오기
		import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
		import { getFirestore } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
		import { collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';
		import { getDocs } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';

		// Firebase 구성 정보 설정
		const firebaseConfig = {
			// For Firebase JS SDK v7.20.0 and later, measurementId is optional
			apiKey: 'AIzaSyDcQ6Q78akg6Oo9Z2VO5APf-QQ7S7kn9DQ',
			authDomain: 'our-stage.firebaseapp.com',
			projectId: 'our-stage',
			storageBucket: 'our-stage.appspot.com',
			messagingSenderId: '999213003989',
			appId: '1:999213003989:web:774432a35de3c233c69e5c',
			measurementId: 'G-G2QMB19RVB',
		};

		// Firebase 인스턴스 초기화
		const app = initializeApp(firebaseConfig);
		const db = getFirestore(app);
		// const data = firestore.collection("profile")
		// console.log(data)

		$('#makeComment').click(async function () {
			let title = $('#title').val();
			let Password = $('#Password').val();
			let comment = $('#comment').val();
			let temp_html = `
				
            <div class="col">
                <div class="card border-info mb-3">
                    <div class="card-body">
                        <h5 class="card-title">${title}</h5>
                        <p class="card-text">${comment}</p>
                        <button type="button" class="btn btn-outline-warning">수정</button>
                        <button type="button" class="btn btn-outline-danger delete-btn">삭제</button>
                    </div>
                </div>
            </div>`;
				$('#card').append(temp_html);

			// 	await addDoc(collection(db, "comment"), doc);
			// alert('저장 완료!');
			// window.location.reload();
		});

		// 삭제기능 //
		$(document).on('click', '#card .delete-btn', function () {
			if ($(this).closest('.card-body').find('.password-input').length === 0) {
				const passwordInput = $('<input>', {
					type: 'password',
					class: 'form-control password-input',
					placeholder: 'Password',
					style: 'margin-top: 10px; width: 200px; height: 30px;',
				});

				const deleteBtn = $(this);
				const cardBody = deleteBtn.closest('.card-body');

				cardBody.append(passwordInput);

				let checkpw = this.Password;

				passwordInput.on('blur', function () { });

				passwordInput.on('keydown', function (e) {
					if (e.key === 'Enter') {
						const enteredPassword = $(this).val();
						const storedPassword = checkpw;

						if (enteredPassword === storedPassword) {
							deleteBtn.closest('.col').remove();
						} else {
							alert('비밀번호가 틀립니다.');
						}
					}
				});
				passwordInput.focus();
			} else {
			}
		});

			// Top 버튼 클릭시 페이지 상단으로 이동
			$(document).ready(function() { 
				$('#top-btn').click(function(){
					$('html, body').animate({scrollTop : 0}, 200);
					return false;
				});
			});
	</script>
</head>

<body>
	<a href="index.html" id="back">X</a>
	<div class="cardMain">
		<div>
			<img id="photo" class="cardImages" src="정해준사진.jpg" alt="이미지를 누르면 연결됩니다." />
		</div>
		<div class="cardStory">
			<h1>정해준</h1>
			<p>경청을 잘 한다고 생각합니다.</p>
			<a href="https://velog.io/@decidedcard">블로그</a>
			<a href="https://github.com/DecidedCard">GitHub</a>
		</div>
	</div>

		<button id="top-btn"></button >

		<form class="comment-wrap">
			<div class="row">
				<div class="col">
					<input id="name" type="text" class="form-control" placeholder="닉네임" aria-label="First name" />
				</div>
				<div class="col-auto">
					<label for="inputPassword2" class="visually-hidden">Password</label>
					<input type="password" class="form-control" id="Password" placeholder="Password" />
				</div>
				<div class="col">
					<input id="comment" type="text" class="form-control" placeholder="comment" aria-label="Last name" />
				</div>
				<div class="col-auto">
					<button id="makeComment" type="button" class="btn btn-primary mb-3">저장</button>
					<button type="button" class="btn btn-primary mb-3">취소</button>
				</div>
			</div>
		</form>

	<div class="commentBox">
		<div id="card" class="row row-cols-1 row-cols-md-4 g-4">
			<div class="col">
				<div class="card border-info mb-3">
					<div class="card-body">
						<h5 class="card-title">닉네임</h5>
						<p class="card-text">comment</p>
						<button type="button" class="btn btn-outline-warning">수정</button>
						<button type="button" class="btn btn-outline-danger">삭제</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>